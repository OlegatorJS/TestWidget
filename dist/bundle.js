(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
var Viewtracker=require("./viewtracker"),util=require("./util"),Datepicker=function(e){this.element=document.querySelector(e),this.today=new Date,this.today.setHours(0,0,0,0),this.prevState="",this.view=new Viewtracker(this.today.getMonth(),this.today.getFullYear()),this.mode=0,this.selected=void 0,this.element.addEventListener("focus",this.hide.bind(this),!1),this.element.addEventListener("input",this.parse.bind(this),!1);var t=document.createElement("div");t.innerHTML=util.template,this.calendar=t.firstChild,document.body.appendChild(this.calendar),this.calendar.addEventListener("click",this.click.bind(this)),window.addEventListener("keydown",this.keydown.bind(this)),t.innerHTML=util.secretTemplate;var i=t.firstChild;this.showbutton=i.querySelector("span.button-show"),this.showbutton.addEventListener("click",this.hideshow.bind(this),!1),util.insertAfter(i,this.element),t.innerHTML=util.suggestionTemplate,i=t.firstChild,util.insertAfter(i,this.showbutton),this.suggestion=i.querySelector("input.suggestion"),this.tips=[],this.tipmode=!1,this.daysview=this.calendar.querySelector("div.daysview"),this.monthsview=this.calendar.querySelector("div.monthsview"),this.yearsview=this.calendar.querySelector("div.yearsview"),this.display=this.calendar.querySelector(".display"),this.calendarbody=this.calendar.querySelector(".calendar"),this.hide(),this.fillDow(),this.fill()};Datepicker.prototype={constructor:Datepicker,parse:function(){var e,t=this.element.value;t=t.split(new RegExp(util.separators.join("|"),"g"));var i=t.length;if(t=t.filter(function(e){return""!=e}),(i-t.length>1||4==i)&&(this.element.value=this.prevState,this.resetsuggestion(),t=this.element.value.split(new RegExp(util.separators.join("|"),"g"))),console.log(t,t.length),0==t.length)return this.prevState="",void(this.suggestion.value="");var s=0;t.length>0&&(util.checkText(t[0])?(this.tips=util.gettips(t[0]),this.tipmode=!0,this.suggestion.value=this.tips[0],s+=1):this.element.value=this.prevState),t.length>1&&(isNaN(t[1])?this.element.value=this.prevState:(e=parseInt(t[1]),1<=e&&e<=util.getDaysInMonth(2015,util.parseMonth(t[0]))?(s+=1,this.suggestion.value="",this.tipmode=!1):this.element.value=this.prevState)),t.length>2&&(isNaN(t[2])?this.element.value=this.prevState:(e=parseInt(t[2]),1<=e&&e<=9999?s+=1:this.element.value=this.prevState)),t.length>3&&(this.element.value=this.prevState),s==t.length&&(this.prevState=this.element.value),t=this.element.value;var h=Date.parse(t);0==isNaN(h)&&(this.selected=new Date(h),this.view.year=this.selected.getFullYear(),this.view.month=this.selected.getMonth(),this.fill())},isOpen:function(){return"block"===this.calendar.style.display},setSelected:function(e,t,i){this.selected=new Date(e,t,i,0,0,0,0),this.resetsuggestion()},keydown:function(e){var t;if(!this.selected&&this.isOpen())return console.log(this.today.getMonth()),this.setSelected(this.today.getFullYear(),this.today.getMonth(),this.today.getDate()),this.set(),void this.fill();if(!this.isOpen()){var i=this.element.value;i=i.split(new RegExp(util.separators.join("|"),"g"));var s=this.element.selectionStart}if(util.letters.indexOf(e.keyCode)>-1&&s<=i[0].length&&i.length>2&&(e.preventDefault(),s<=i[0].length&&(i[0]=String.fromCharCode(e.keyCode),i[1]&&i[1].trim()&&i.splice(1,0,"                     "),this.element.value=i.join(" "),this.tips=util.gettips(i[0]),this.tipmode=!0,this.suggestion.value=this.tips[0],this.element.selectionStart=s,this.element.selectionEnd=s)),e.keyCode>=48&&e.keyCode<=57&&!this.isOpen()&&(e.preventDefault(),i=i.join(" "),s==i.length?i+=String.fromCharCode(e.keyCode):i=util.setCharAt(i,s,String.fromCharCode(e.keyCode)),this.element.value=i,this.parse(),this.element.selectionStart=s+1,this.element.selectionEnd=s+1),39!=e.keyCode&&32!=e.keyCode||this.isOpen()||!this.tipmode||(i.length>3?(i=i.filter(function(e){return""!=e}),i[0]=this.suggestion.value,this.element.value=i.join(" "),this.parse()):(this.element.value=this.suggestion.value+" ",this.tipmode=!1)),(38==e.keyCode||40==e.keyCode)&&!this.isOpen()&&this.tipmode){e.preventDefault(),t=38==e.keyCode?1:-1;var h=this.tips.indexOf(this.suggestion.value)+t;h==this.tips.length&&(h=0),h<0&&(h=this.tips.length-1),this.suggestion.value=this.tips[h]}if(!(38!=e.keyCode&&40!=e.keyCode||this.isOpen()||this.tipmode)){if(e.preventDefault(),i.length<3)return;t=38==e.keyCode?1:-1,s<=i[0].length&&(this.view.changemonth(t),this.setSelected(this.view.year,this.view.month,this.selected.getDate()),this.set(),this.element.selectionStart=s,this.element.selectionEnd=s),s>i[0].length&&s<=i[0].length+1+i[1].length&&(this.setSelected(this.view.year,this.view.month,this.selected.getDate()+t),this.set(),this.element.selectionStart=s,this.element.selectionEnd=s,this.view.year=this.selected.getFullYear(),this.view.month=this.selected.getMonth()),s>i[0].length+1+i[1].length&&(this.view.changeyear(t),this.setSelected(this.view.year,this.view.month,this.selected.getDate()),this.set(),this.element.selectionStart=s,this.element.selectionEnd=s,this.view.year=this.selected.getFullYear(),this.view.month=this.selected.getMonth())}if(this.isOpen()&&[37,38,39,40,32,16].indexOf(e.keyCode)>-1){switch(e.preventDefault(),e.keyCode){case 37:switch(this.mode){case 0:this.setSelected(this.view.year,this.view.month,this.selected.getDate()-1);break;case 1:this.view.changemonth(-1),this.setSelected(this.view.year,this.view.month,this.selected.getDate());break;case 2:this.view.changeyear(-1),this.setSelected(this.view.year,this.view.month,this.selected.getDate())}break;case 38:switch(this.mode){case 0:this.setSelected(this.view.year,this.view.month,this.selected.getDate()-7);break;case 1:this.view.changemonth(-3),this.setSelected(this.view.year,this.view.month,this.selected.getDate());break;case 2:this.view.changeyear(-4),this.setSelected(this.view.year,this.view.month,this.selected.getDate())}break;case 39:switch(this.mode){case 0:this.setSelected(this.view.year,this.view.month,this.selected.getDate()+1);break;case 1:this.view.changemonth(1),this.setSelected(this.view.year,this.view.month,this.selected.getDate());break;case 2:this.view.changeyear(1),this.setSelected(this.view.year,this.view.month,this.selected.getDate())}break;case 40:switch(this.mode){case 0:this.setSelected(this.view.year,this.view.month,this.selected.getDate()+7);break;case 1:this.view.changemonth(3),this.setSelected(this.view.year,this.view.month,this.selected.getDate());break;case 2:this.view.changeyear(4),this.setSelected(this.view.year,this.view.month,this.selected.getDate())}break;case 32:0==this.mode?this.hide():this.changeView(-1);break;case 16:this.changeView(1)}this.view.year=this.selected.getFullYear(),this.view.month=this.selected.getMonth(),this.set(),this.fill()}},set:function(){var e="";e+=util.dates.months[this.selected.getMonth()]+" ",e+=this.selected.getDate()+" ",e+=this.selected.getFullYear(),this.element.value=e,this.prevState=e},fillDow:function(){for(var e="",t=0;t<7;)e+='<div class="dow">'+util.dates.daysShort[t++].toUpperCase()+"</div>";this.calendar.querySelector("div.calendarhead").innerHTML=e},fillMonths:function(e){for(var t,i="",s=0;s<12;)t="",this.selected&&s==this.selected.getMonth()&&(t=" active"),i+='<div class="month'+t+'">'+util.dates.monthsShort[s++]+"</div>";this.monthsview.innerHTML=i},updateDisplay:function(){var e=this.view.year,t=this.view.month;0==this.mode?this.display.innerHTML=util.dates.months[t]+" "+e:1==this.mode?this.display.innerHTML=e:2==this.mode&&(e=16*Math.floor(e/16),this.display.innerHTML=e+" - "+(e+15))},settoday:function(){this.selected=this.today,this.view.year=this.selected.getFullYear(),this.view.month=this.selected.getMonth(),this.set(),this.fill(),this.hide()},fill:function(){var e=this.view.year,t=this.view.month,i=0;switch(this.selected&&(i=this.selected.valueOf()),this.mode){case 0:this.updateDisplay();var s=new Date(e,t-1,28,0,0,0,0),h=util.getDaysInMonth(s.getFullYear(),s.getMonth());s.setDate(h),s.setDate(h-(s.getDay()+7)%7);var a=new Date(s);a.setDate(a.getDate()+42),a=a.valueOf();for(var n,l,o,r="";s.valueOf()<a;)l=s.getFullYear(),o=s.getMonth(),n="",o<t&&l===e||l<e?n=" old":(o>t&&l===e||l>e)&&(n=" new"),s.valueOf()===this.today.valueOf()&&(n=" now"),s.valueOf()===i&&(n=" active"),r+='<div class="day'+n+'">'+s.getDate()+"</div>",s.setDate(s.getDate()+1);this.calendarbody.innerHTML=r;break;case 1:this.fillMonths(t),this.updateDisplay();break;case 2:r="",e=16*Math.floor(e/16);var d=0;this.selected&&(d=this.selected.getFullYear()),this.updateDisplay();for(var c=-1;c<15;c++)r+='<div class="year'+(d===e?" active":"")+'">'+e+"</div>",e+=1;this.yearsview.innerHTML=r}},hideshow:function(){"block"==this.calendar.style.display?this.hide():this.show()},resetsuggestion:function(){this.suggestion.value="",this.tipmode=!1},show:function(){this.place(),this.parse(),this.calendar.style.display="block",window.addEventListener("resize",this.place.bind(this))},hide:function(){this.calendar.style.display="none"},place:function(){var e=util.calculateOffset(this.element);this.calendar.style.top=e.top+this.element.offsetHeight+3+"px",this.calendar.style.left=e.left+"px"},click:function(e){e.preventDefault(),e.stopPropagation();var t=e.target;switch(t.className){case"inc control":case"dec control":this.view[this.view.modes[this.mode].param].call(this.view,(t.className.indexOf("dec")>-1?-1:1)*this.view.modes[this.mode].step),this.fill();break;case"display":this.changeView(1),this.fill();break;case"day":case"day old":case"day new":case"day now":case"day active":var i=this.view.month;t.className.indexOf("old")>-1&&(i-=1,this.view.changemonth(-1)),t.className.indexOf("new")>-1&&(i+=1,this.view.changemonth(1));var s=parseInt(t.innerHTML,10);this.setSelected(this.view.year,i,s),this.set(),this.fill(),this.hide();break;case"month":case"month active":this.view.month=util.dates.monthsShort.indexOf(t.innerHTML),this.changeView(-1),this.fill();break;case"year":case"year active":this.view.year=parseInt(t.innerHTML,10),this.changeView(-1),this.updateDisplay();break;case"today":this.settoday()}},changeView:function(e){this.mode>=2&&1==e||(this.mode+=e,0==this.mode?(this.monthsview.style.display="none",this.daysview.style.display="block"):1==this.mode?(this.daysview.style.display="none",this.yearsview.style.display="none",this.monthsview.style.display="block"):2==this.mode&&(this.monthsview.style.display="none",this.yearsview.style.display="block"))}},window.Datepicker=Datepicker;

},{"./util":2,"./viewtracker":3}],2:[function(require,module,exports){
var util={dates:{days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],daysShort:["Su","Mo","Tu","We","Th","Fr","Sa","Su"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],monthslow:["january","february","march","april","may","june","july","august","september","october","november","december"],monthsShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]},separators:[" ",",","-","\\.","/",":"],letters:[70,65,68,83,79,78,74],parseMonth:function(e){return isNaN(e)?util.dates.monthslow.indexOf(e.toLowerCase()):e-1},isLeapYear:function(e){return e%4==0&&e%100!=0||e%400==0},getDaysInMonth:function(e,t){return[31,util.isLeapYear(e)?29:28,31,30,31,30,31,31,30,31,30,31][t]},calculateOffset:function(e){var t=0,s=0;do{t+=e.offsetTop||0,s+=e.offsetLeft||0,e=e.offsetParent}while(e);return{top:t,left:s}},setCharAt:function(e,t,s){return t>e.length-1?e:e.substr(0,t)+s+e.substr(t+1)},checkText:function(e){for(var t=0;t<12;t++)if(0==util.dates.monthslow[t].indexOf(e.toLowerCase())||e==(t+1).toString())return!0;return!1},gettips:function(e){var t,s=[];t=e[0]==e[0].toUpperCase()?util.dates.months:util.dates.monthslow;for(var a=0;a<12;a++)0==util.dates.monthslow[a].indexOf(e.toLowerCase())&&s.push(t[a]);return s},insertAfter:function(e,t){t.parentNode.insertBefore(e,t.nextSibling)},template:'<div class="datepickerbody"><div class="head"><div class="dec control"></div><div class="display">September 2014</div><div class="inc control"></div></div><div class="body"><div class="daysview"><div class="calendarhead"></div><div class="calendar"></div></div><div class="monthsview"></div><div class="yearsview"></div></div><div class="today">Today</div></div>',secretTemplate:'<span><span class="button-show"><div class="icon-1"><div class="icon-2"></div></div></span></span>',suggestionTemplate:'<div><input class="suggestion" disabled type="text"></div>'};module.exports=util;

},{}],3:[function(require,module,exports){
var Viewtracker=function(t,h){this.month=t,this.year=h,this.changemonth=function(t){this.month+=t,12==this.month&&(this.month=0,this.year+=1),-1==this.month&&(this.month=11,this.year-=1)},this.changeyear=function(t){this.year+=t},this.modes=[{param:"changemonth",step:1},{param:"changeyear",step:1},{param:"changeyear",step:16}]};module.exports=Viewtracker;

},{}]},{},[1])
//# sourceMappingURL=data:application/json;charset:utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJzcmNcXGpzXFxkYXRlcGlja2VyLmpzIiwic3JjXFxqc1xcdXRpbC5qcyIsInNyY1xcanNcXHZpZXd0cmFja2VyLmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0FDQUEsR0FBSSxhQUFjLFFBQVEsaUJBQ3RCLEtBQU8sUUFBUSxVQUVmLFdBQWEsU0FBUyxHQUN0QixLQUFLLFFBQVUsU0FBUyxjQUFjLEdBRXRDLEtBQUssTUFBUSxHQUFJLE1BQ2pCLEtBQUssTUFBTSxTQUFTLEVBQUUsRUFBRSxFQUFFLEdBRTFCLEtBQUssVUFBWSxHQUVqQixLQUFLLEtBQU8sR0FBSSxhQUFZLEtBQUssTUFBTSxXQUFZLEtBQUssTUFBTSxlQUU5RCxLQUFLLEtBQU8sRUFDWixLQUFLLGFBQVcsR0FDaEIsS0FBSyxRQUFRLGlCQUFpQixRQUFTLEtBQUssS0FBSyxLQUFLLE9BQU8sR0FDN0QsS0FBSyxRQUFRLGlCQUFpQixRQUFTLEtBQUssTUFBTSxLQUFLLE9BQU8sRUFFOUQsSUFBSSxHQUFPLFNBQVMsY0FBYyxNQUVsQyxHQUFLLFVBQVksS0FBSyxTQUN0QixLQUFLLFNBQVcsRUFBSyxXQUNyQixTQUFTLEtBQUssWUFBWSxLQUFLLFVBQy9CLEtBQUssU0FBUyxpQkFBaUIsUUFBUyxLQUFLLE1BQU0sS0FBSyxPQUN4RCxPQUFPLGlCQUFpQixVQUFXLEtBQUssUUFBUSxLQUFLLE9BRXJELEVBQUssVUFBWSxLQUFLLGNBQ3RCLElBQUksR0FBYSxFQUFLLFVBQ3RCLE1BQUssV0FBYSxFQUFXLGNBQWMsb0JBQzNDLEtBQUssV0FBVyxpQkFBaUIsUUFBUyxLQUFLLFNBQVMsS0FBSyxPQUFPLEdBQ3BFLEtBQUssWUFBWSxFQUFZLEtBQUssU0FFbEMsRUFBSyxVQUFZLEtBQUssbUJBQ3RCLEVBQWEsRUFBSyxXQUNsQixLQUFLLFlBQVksRUFBWSxLQUFLLFlBQ2xDLEtBQUssV0FBYSxFQUFXLGNBQWMs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QUFHLEdBQUcsR0FBRyxJQUFJLFFBQVEsRUFBRSxVQUFVLEVBQUcsQ0FFM0QsT0FEQSxFQUFFLGlCQUNNLEVBQUUsU0FDTixJQUFLLElBQ0QsT0FBUSxLQUFLLE1BQ1QsSUFBSyxHQUNELEtBQUssWUFBWSxLQUFLLEtBQUssS0FBTSxLQUFLLEtBQUssTUFBTyxLQUFLLFNBQVMsVUFBWSxFQUM1RSxNQUNKLEtBQUssR0FDRCxLQUFLLEtBQUssYUFBYSxHQUN2QixLQUFLLFlBQVksS0FBSyxLQUFLLEtBQU0sS0FBSyxLQUFLLE1BQU8sS0FBSyxTQUFTLFVBQ2hFLE1BQ0osS0FBSyxHQUNELEtBQUssS0FBSyxZQUFZLEdBQ3RCLEtBQUssWUFBWSxLQUFLLEtBQUssS0FBTSxLQUFLLEtBQUssTUFBTyxLQUFLLFNBQVMsV0FHeEUsS0FDSixLQUFLLElBQ0QsT0FBUSxLQUFLLE1BQ1QsSUFBSyxHQUNELEtBQUssWUFBWSxLQUFLLEtBQUssS0FBTSxLQUFLLEtBQUssTUFBTyxLQUFLLFNBQVMsVUFBWSxFQUM1RSxNQUNKLEtBQUssR0FDRCxLQUFLLEtBQUssYUFBYSxHQUN2QixLQUFLLFlBQVksS0FBSyxLQUFLLEtBQU0sS0FBSyxLQUFLLE1BQU8sS0FBSyxTQUFTLFVBQ2hFLE1BQ0osS0FBSyxHQUNELEtBQUssS0FBSyxZQUFZLEdBQ3RCLEtBQUssWUFBWSxLQUFLLEtBQUssS0FBTSxLQUFLLEtBQUssTUFBTyxLQUFLLFNBQVMsV0FHeEUsS0FDSixLQUFLLElBQ0QsT0FBUSxLQUFLLE1BQ1QsSUFBSyxHQUNELEtBQUssWUFBWSxLQUFLLEtBQUssS0FBTSxLQUFLLEtBQUssTUFBTyxLQUFLLFNBQVMsVUFBWSxFQUM1RSxNQUNKLEtBQUssR0FDRCxLQUFLLEtBQUssWUFBWSxHQUN0QixLQUFLLFlBQVksS0FBSyxLQUFLLEtBQU0sS0FBSyxLQUFLLE1BQU8sS0FBSyxTQUFTLFVBQ2hFLE1BQ0osS0FBSyxHQUNELEtBQUssS0FBSyxXQUFXLEdBQ3JCLEtBQUssWUFBWSxLQUFLLEtBQUssS0FBTSxLQUFLLEtBQUss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LEVBQ3pCLEVBQUksT0FBTyxFQUFFLEdBQVMsRUFBTSxFQUFJLE9BQU8sRUFBTSxJQUV4RCxVQUFXLFNBQVMsR0FDaEIsSUFBSSxHQUFJLEdBQUUsRUFBRyxFQUFFLEdBQUksSUFDZixHQUEwRCxHQUF2RCxLQUFLLE1BQU0sVUFBVSxHQUFHLFFBQVEsRUFBSyxnQkFBdUIsSUFBUyxFQUFFLEdBQUcsV0FDekUsT0FBTyxDQUdmLFFBQU8sR0FFWCxRQUFTLFNBQVMsR0FDZCxHQUFjLEdBQVYsSUFFQSxHQURELEVBQUssSUFBTSxFQUFLLEdBQUcsY0FDVCxLQUFLLE1BQU0sT0FFWCxLQUFLLE1BQU0sU0FHeEIsS0FBSSxHQUFJLEdBQUUsRUFBRyxFQUFFLEdBQUksSUFDMkMsR0FBdkQsS0FBSyxNQUFNLFVBQVUsR0FBRyxRQUFRLEVBQUssZ0JBQ3BDLEVBQUksS0FBSyxFQUFPLEdBR3hCLE9BQU8sSUFFWCxZQUFhLFNBQVMsRUFBUyxHQUMzQixFQUFjLFdBQVcsYUFBYSxFQUFTLEVBQWMsY0FFakUsU0FBWSw2V0FvQlosZUFBZ0IscUdBQ2hCLG1CQUFvQiw2REFHeEIsUUFBTyxRQUFVOzs7QUMxRmpCLEdBQUksYUFBYyxTQUFTLEVBQU8sR0FFOUIsS0FBSyxNQUFRLEVBQ2IsS0FBSyxLQUFPLEVBRVosS0FBSyxZQUFjLFNBQVMsR0FDeEIsS0FBSyxPQUFPLEVBQ0csSUFBWixLQUFLLFFBQ0osS0FBSyxNQUFNLEVBQ1gsS0FBSyxNQUFNLElBRUMsR0FBYixLQUFLLFFBQ0osS0FBSyxNQUFNLEdBQ1gsS0FBSyxNQUFNLElBSW5CLEtBQUssV0FBYSxTQUFTLEdBQ3ZCLEtBQUssTUFBTSxHQUdmLEtBQUssUUFFRyxNQUFRLGNBQ1IsS0FBTyxJQUdQLE1BQVEsYUFDUixLQUFPLElBR1AsTUFBUSxhQUNSLEtBQU8sS0FLbkIsUUFBTyxRQUFVIiwiZmlsZSI6ImdlbmVyYXRlZC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24gZSh0LG4scil7ZnVuY3Rpb24gcyhvLHUpe2lmKCFuW29dKXtpZighdFtvXSl7dmFyIGE9dHlwZW9mIHJlcXVpcmU9PVwiZnVuY3Rpb25cIiYmcmVxdWlyZTtpZighdSYmYSlyZXR1cm4gYShvLCEwKTtpZihpKXJldHVybiBpKG8sITApO3ZhciBmPW5ldyBFcnJvcihcIkNhbm5vdCBmaW5kIG1vZHVsZSAnXCIrbytcIidcIik7dGhyb3cgZi5jb2RlPVwiTU9EVUxFX05PVF9GT1VORFwiLGZ9dmFyIGw9bltvXT17ZXhwb3J0czp7fX07dFtvXVswXS5jYWxsKGwuZXhwb3J0cyxmdW5jdGlvbihlKXt2YXIgbj10W29dWzFdW2VdO3JldHVybiBzKG4/bjplKX0sbCxsLmV4cG9ydHMsZSx0LG4scil9cmV0dXJuIG5bb10uZXhwb3J0c312YXIgaT10eXBlb2YgcmVxdWlyZT09XCJmdW5jdGlvblwiJiZyZXF1aXJlO2Zvcih2YXIgbz0wO288ci5sZW5ndGg7bysrKXMocltvXSk7cmV0dXJuIHN9KSIsInZhciBWaWV3dHJhY2tlciA9IHJlcXVpcmUoJy4vdmlld3RyYWNrZXInKSxcbiAgICB1dGlsID0gcmVxdWlyZSgnLi91dGlsJylcblxudmFyIERhdGVwaWNrZXIgPSBmdW5jdGlvbihlbCkge1xuICAgIHRoaXMuZWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoZWwpO1xuXG4gICAgdGhpcy50b2RheSA9IG5ldyBEYXRlKCk7XG4gICAgdGhpcy50b2RheS5zZXRIb3VycygwLDAsMCwwKTtcblxuICAgIHRoaXMucHJldlN0YXRlID0gXCJcIjtcblxuICAgIHRoaXMudmlldyA9IG5ldyBWaWV3dHJhY2tlcih0aGlzLnRvZGF5LmdldE1vbnRoKCksIHRoaXMudG9kYXkuZ2V0RnVsbFllYXIoKSk7XG5cbiAgICB0aGlzLm1vZGUgPSAwOyAgICAgICAgICAgICAgLy8wLWRheXMsIDEtbW9udGgsIDIteWVhcnNcbiAgICB0aGlzLnNlbGVjdGVkID0gdW5kZWZpbmVkOyAgLy9iZWNhdXNlIHdoeSBub3RcbiAgICB0aGlzLmVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignZm9jdXMnLCB0aGlzLmhpZGUuYmluZCh0aGlzKSwgZmFsc2UpO1xuICAgIHRoaXMuZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdpbnB1dCcsIHRoaXMucGFyc2UuYmluZCh0aGlzKSwgZmFsc2UpO1xuXG4gICAgdmFyIHdyYXAgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcblxuICAgIHdyYXAuaW5uZXJIVE1MID0gdXRpbC50ZW1wbGF0ZTtcbiAgICB0aGlzLmNhbGVuZGFyID0gd3JhcC5maXJzdENoaWxkO1xuICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQodGhpcy5jYWxlbmRhcik7XG4gICAgdGhpcy5jYWxlbmRhci5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHRoaXMuY2xpY2suYmluZCh0aGlzKSk7XG4gICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCB0aGlzLmtleWRvd24uYmluZCh0aGlzKSk7XG5cbiAgICB3cmFwLmlubmVySFRNTCA9IHV0aWwuc2VjcmV0VGVtcGxhdGU7XG4gICAgdmFyIGJ1dHRvbndyYXAgPSB3cmFwLmZpcnN0Q2hpbGQ7XG4gICAgdGhpcy5zaG93YnV0dG9uID0gYnV0dG9ud3JhcC5xdWVyeVNlbGVjdG9yKCdzcGFuLmJ1dHRvbi1zaG93Jyk7XG4gICAgdGhpcy5zaG93YnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgdGhpcy5oaWRlc2hvdy5iaW5kKHRoaXMpLCBmYWxzZSk7XG4gICAgdXRpbC5pbnNlcnRBZnRlcihidXR0b253cmFwLCB0aGlzLmVsZW1lbnQpO1xuXG4gICAgd3JhcC5pbm5lckhUTUwgPSB1dGlsLnN1Z2dlc3Rpb25UZW1wbGF0ZTtcbiAgICBidXR0b253cmFwID0gd3JhcC5maXJzdENoaWxkO1xuICAgIHV0aWwuaW5zZXJ0QWZ0ZXIoYnV0dG9ud3JhcCwgdGhpcy5zaG93YnV0dG9uKTtcbiAgICB0aGlzLnN1Z2dlc3Rpb24gPSBidXR0b253cmFwLnF1ZXJ5U2VsZWN0b3IoJ2lucHV0LnN1Z2dlc3Rpb24nKTtcbiAgICB0aGlzLnRpcHMgPSBbXTtcbiAgICB0aGlzLnRpcG1vZGUgPSBmYWxzZTtcblxuICAgIHRoaXMuZGF5c3ZpZXcgPSB0aGlzLmNhbGVuZGFyLnF1ZXJ5U2VsZWN0b3IoJ2Rpdi5kYXlzdmlldycpO1xuICAgIHRoaXMubW9udGhzdmlldyA9IHRoaXMuY2FsZW5kYXIucXVlcnlTZWxlY3RvcignZGl2Lm1vbnRoc3ZpZXcnKTtcbiAgICB0aGlzLnllYXJzdmlldyA9IHRoaXMuY2FsZW5kYXIucXVlcnlTZWxlY3RvcignZGl2LnllYXJzdmlldycpO1xuICAgIHRoaXMuZGlzcGxheSA9ICB0aGlzLmNhbGVuZGFyLnF1ZXJ5U2VsZWN0b3IoJy5kaXNwbGF5Jyk7XG4gICAgdGhpcy5jYWxlbmRhcmJvZHkgPSB0aGlzLmNhbGVuZGFyLnF1ZXJ5U2VsZWN0b3IoJy5jYWxlbmRhcicpO1xuXG4gICAgdGhpcy5oaWRlKCk7XG4gICAgdGhpcy5maWxsRG93KCk7XG4gICAgdGhpcy5maWxsKCk7XG59O1xuXG5EYXRlcGlja2VyLnByb3RvdHlwZSA9IHtcbiAgICBjb25zdHJ1Y3RvcjogRGF0ZXBpY2tlcixcblxuICAgIHBhcnNlOiBmdW5jdGlvbigpIHtcbiAgICAgICAgdmFyIHZhbCA9IHRoaXMuZWxlbWVudC52YWx1ZSwgbnVtO1xuICAgICAgICB2YWwgPSB2YWwuc3BsaXQobmV3IFJlZ0V4cCh1dGlsLnNlcGFyYXRvcnMuam9pbignfCcpLCAnZycpKTtcbiAgICAgICAgdmFyIHRlbXBsZW4gPSB2YWwubGVuZ3RoO1xuXG4gICAgICAgIHZhbCA9IHZhbC5maWx0ZXIoZnVuY3Rpb24obil7IHJldHVybiBuICE9IFwiXCIgfSk7XG5cbiAgICAgICAgaWYoKHRlbXBsZW4gLSB2YWwubGVuZ3RoKSA+IDEgfHwgdGVtcGxlbj09NCkge1xuICAgICAgICAgICAgdGhpcy5lbGVtZW50LnZhbHVlID0gdGhpcy5wcmV2U3RhdGU7XG4gICAgICAgICAgICB0aGlzLnJlc2V0c3VnZ2VzdGlvbigpO1xuICAgICAgICAgICAgdmFsID0gdGhpcy5lbGVtZW50LnZhbHVlLnNwbGl0KG5ldyBSZWdFeHAodXRpbC5zZXBhcmF0b3JzLmpvaW4oJ3wnKSwgJ2cnKSk7XG4gICAgICAgIH1cblxuICAgICAgICBjb25zb2xlLmxvZyh2YWwsIHZhbC5sZW5ndGgpO1xuXG4gICAgICAgIGlmKHZhbC5sZW5ndGg9PTApIHtcbiAgICAgICAgICAgIHRoaXMucHJldlN0YXRlID0gXCJcIjtcbiAgICAgICAgICAgIHRoaXMuc3VnZ2VzdGlvbi52YWx1ZSA9IFwiXCI7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICB2YXIgY291bnQgPSAwO1xuXG4gICAgICAgIGlmKHZhbC5sZW5ndGg+MCkge1xuICAgICAgICAgICAgaWYgKHV0aWwuY2hlY2tUZXh0KHZhbFswXSkpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnRpcHMgPSB1dGlsLmdldHRpcHModmFsWzBdKTtcbiAgICAgICAgICAgICAgICB0aGlzLnRpcG1vZGUgPSB0cnVlO1xuICAgICAgICAgICAgICAgIHRoaXMuc3VnZ2VzdGlvbi52YWx1ZSA9IHRoaXMudGlwc1swXTtcbiAgICAgICAgICAgICAgICBjb3VudCs9MTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhpcy5lbGVtZW50LnZhbHVlID0gdGhpcy5wcmV2U3RhdGU7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBpZih2YWwubGVuZ3RoPjEpIHtcbiAgICAgICAgICAgIGlmIChpc05hTih2YWxbMV0pKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5lbGVtZW50LnZhbHVlID0gdGhpcy5wcmV2U3RhdGU7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIG51bSA9IHBhcnNlSW50KHZhbFsxXSk7XG4gICAgICAgICAgICAgICAgaWYgKDEgPD0gbnVtICYmIG51bSA8PSB1dGlsLmdldERheXNJbk1vbnRoKDIwMTUsIHV0aWwucGFyc2VNb250aCh2YWxbMF0pKSkge1xuICAgICAgICAgICAgICAgICAgICBjb3VudCs9MTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zdWdnZXN0aW9uLnZhbHVlID0gXCJcIjtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy50aXBtb2RlID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5lbGVtZW50LnZhbHVlID0gdGhpcy5wcmV2U3RhdGU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgaWYodmFsLmxlbmd0aD4yKSB7XG5cbiAgICAgICAgICAgIGlmKGlzTmFOKHZhbFsyXSkpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmVsZW1lbnQudmFsdWUgPSB0aGlzLnByZXZTdGF0ZTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgbnVtID0gcGFyc2VJbnQodmFsWzJdKTtcbiAgICAgICAgICAgICAgICBpZiggMSA8PSBudW0gJiYgbnVtIDw9IDk5OTkpIHtcbiAgICAgICAgICAgICAgICAgICAgY291bnQrPTE7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5lbGVtZW50LnZhbHVlID0gdGhpcy5wcmV2U3RhdGU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cblxuICAgICAgICBpZih2YWwubGVuZ3RoPjMpIHtcbiAgICAgICAgICAgIHRoaXMuZWxlbWVudC52YWx1ZSA9IHRoaXMucHJldlN0YXRlO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYoY291bnQ9PXZhbC5sZW5ndGgpIHtcbiAgICAgICAgICAgIHRoaXMucHJldlN0YXRlID0gdGhpcy5lbGVtZW50LnZhbHVlO1xuICAgICAgICB9XG5cbiAgICAgICAgdmFsID0gdGhpcy5lbGVtZW50LnZhbHVlO1xuICAgICAgICB2YXIgZGF0ZSA9IERhdGUucGFyc2UodmFsKTtcblxuICAgICAgICBpZihpc05hTihkYXRlKT09ZmFsc2UpIHtcbiAgICAgICAgICAgIHRoaXMuc2VsZWN0ZWQgPSBuZXcgRGF0ZShkYXRlKTtcbiAgICAgICAgICAgIHRoaXMudmlldy55ZWFyID0gdGhpcy5zZWxlY3RlZC5nZXRGdWxsWWVhcigpO1xuICAgICAgICAgICAgdGhpcy52aWV3Lm1vbnRoID0gdGhpcy5zZWxlY3RlZC5nZXRNb250aCgpO1xuICAgICAgICAgICAgdGhpcy5maWxsKCk7XG4gICAgICAgIH1cblxuICAgIH0sXG5cbiAgICBpc09wZW46IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIHRoaXMuY2FsZW5kYXIuc3R5bGUuZGlzcGxheT09PSdibG9jayc7XG4gICAgfSxcblxuICAgIHNldFNlbGVjdGVkOiBmdW5jdGlvbih5ZWFyLCBtb250aCwgZGF0ZSkge1xuICAgICAgICB0aGlzLnNlbGVjdGVkID0gbmV3IERhdGUoeWVhcixtb250aCxkYXRlLDAsMCwwLDApO1xuICAgICAgICB0aGlzLnJlc2V0c3VnZ2VzdGlvbigpO1xuICAgIH0sXG5cbiAgICBrZXlkb3duOiBmdW5jdGlvbihlKSB7XG5cbiAgICAgICAgdmFyIGQ7XG5cbiAgICAgICAgaWYoIXRoaXMuc2VsZWN0ZWQgJiYgdGhpcy5pc09wZW4oKSkge1xuICAgICAgICAgICAgY29uc29sZS5sb2codGhpcy50b2RheS5nZXRNb250aCgpKTtcbiAgICAgICAgICAgIHRoaXMuc2V0U2VsZWN0ZWQodGhpcy50b2RheS5nZXRGdWxsWWVhcigpLHRoaXMudG9kYXkuZ2V0TW9udGgoKSx0aGlzLnRvZGF5LmdldERhdGUoKSk7XG4gICAgICAgICAgICB0aGlzLnNldCgpO1xuICAgICAgICAgICAgdGhpcy5maWxsKCk7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICBpZighdGhpcy5pc09wZW4oKSkge1xuICAgICAgICAgICAgdmFyIHZhbCA9IHRoaXMuZWxlbWVudC52YWx1ZTtcbiAgICAgICAgICAgIHZhbCA9IHZhbC5zcGxpdChuZXcgUmVnRXhwKHV0aWwuc2VwYXJhdG9ycy5qb2luKCd8JyksICdnJykpO1xuICAgICAgICAgICAgdmFyIHBvcyA9IHRoaXMuZWxlbWVudC5zZWxlY3Rpb25TdGFydDtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmKHV0aWwubGV0dGVycy5pbmRleE9mKGUua2V5Q29kZSk+LTEgJiYgcG9zPD12YWxbMF0ubGVuZ3RoICYmIHZhbC5sZW5ndGg+Mikge1xuICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgaWYocG9zPD12YWxbMF0ubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgdmFsWzBdID0gU3RyaW5nLmZyb21DaGFyQ29kZShlLmtleUNvZGUpO1xuXG4gICAgICAgICAgICAgICAgaWYodmFsWzFdICYmIHZhbFsxXS50cmltKCkpXG4gICAgICAgICAgICAgICAgICAgIHZhbC5zcGxpY2UoMSwgMCwgXCIgICAgICAgICAgICAgICAgICAgICBcIik7XG5cbiAgICAgICAgICAgICAgICB0aGlzLmVsZW1lbnQudmFsdWUgPSB2YWwuam9pbignICcpO1xuXG4gICAgICAgICAgICAgICAgdGhpcy50aXBzID0gdXRpbC5nZXR0aXBzKHZhbFswXSk7XG4gICAgICAgICAgICAgICAgdGhpcy50aXBtb2RlID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICB0aGlzLnN1Z2dlc3Rpb24udmFsdWUgPSB0aGlzLnRpcHNbMF07XG5cbiAgICAgICAgICAgICAgICB0aGlzLmVsZW1lbnQuc2VsZWN0aW9uU3RhcnQgPSBwb3M7XG4gICAgICAgICAgICAgICAgdGhpcy5lbGVtZW50LnNlbGVjdGlvbkVuZCA9IHBvcztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGlmKGUua2V5Q29kZSA+PSA0OCAmJiBlLmtleUNvZGUgPD0gNTcgJiYgIXRoaXMuaXNPcGVuKCkpIHtcbiAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgIHZhbCA9IHZhbC5qb2luKCcgJyk7XG5cbiAgICAgICAgICAgIGlmKHBvcz09dmFsLmxlbmd0aClcbiAgICAgICAgICAgICAgICB2YWwgKz0gU3RyaW5nLmZyb21DaGFyQ29kZShlLmtleUNvZGUpO1xuICAgICAgICAgICAgZWxzZVxuICAgICAgICAgICAgICAgIHZhbCA9IHV0aWwuc2V0Q2hhckF0KHZhbCxwb3MsU3RyaW5nLmZyb21DaGFyQ29kZShlLmtleUNvZGUpKTtcblxuICAgICAgICAgICAgdGhpcy5lbGVtZW50LnZhbHVlID0gdmFsO1xuICAgICAgICAgICAgdGhpcy5wYXJzZSgpO1xuXG4gICAgICAgICAgICB0aGlzLmVsZW1lbnQuc2VsZWN0aW9uU3RhcnQgPSBwb3MrMTtcbiAgICAgICAgICAgIHRoaXMuZWxlbWVudC5zZWxlY3Rpb25FbmQgPSBwb3MrMTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmKChlLmtleUNvZGU9PTM5IHx8IGUua2V5Q29kZT09MzIpICYmICF0aGlzLmlzT3BlbigpICYmIHRoaXMudGlwbW9kZSkge1xuICAgICAgICAgICAgaWYodmFsLmxlbmd0aD4zKSB7XG4gICAgICAgICAgICAgICAgdmFsID0gdmFsLmZpbHRlcihmdW5jdGlvbihuKXsgcmV0dXJuIG4gIT0gXCJcIiB9KTtcbiAgICAgICAgICAgICAgICB2YWxbMF0gPSB0aGlzLnN1Z2dlc3Rpb24udmFsdWU7XG4gICAgICAgICAgICAgICAgdGhpcy5lbGVtZW50LnZhbHVlID0gdmFsLmpvaW4oJyAnKTtcbiAgICAgICAgICAgICAgICB0aGlzLnBhcnNlKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aGlzLmVsZW1lbnQudmFsdWUgPSB0aGlzLnN1Z2dlc3Rpb24udmFsdWUgKyBcIiBcIjtcbiAgICAgICAgICAgICAgICB0aGlzLnRpcG1vZGUgPSBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGlmKChlLmtleUNvZGU9PTM4IHx8IGUua2V5Q29kZT09NDApICYmICF0aGlzLmlzT3BlbigpICYmIHRoaXMudGlwbW9kZSkge1xuICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuXG4gICAgICAgICAgICBkID0gKGUua2V5Q29kZSA9PSAzOCkgPyAxIDogLTE7XG4gICAgICAgICAgICB2YXIgaW5kZXggPSB0aGlzLnRpcHMuaW5kZXhPZih0aGlzLnN1Z2dlc3Rpb24udmFsdWUpICsgZDtcblxuICAgICAgICAgICAgaWYoaW5kZXggPT0gdGhpcy50aXBzLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgIGluZGV4ID0gMDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmKGluZGV4IDwgMCkge1xuICAgICAgICAgICAgICAgIGluZGV4ID0gdGhpcy50aXBzLmxlbmd0aCAtIDE7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHRoaXMuc3VnZ2VzdGlvbi52YWx1ZSA9IHRoaXMudGlwc1tpbmRleF07XG4gICAgICAgIH1cblxuICAgICAgICBpZigoZS5rZXlDb2RlPT0zOCB8fCBlLmtleUNvZGU9PTQwKSAmJiAhdGhpcy5pc09wZW4oKSAmJiAhdGhpcy50aXBtb2RlKSB7XG4gICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG5cbiAgICAgICAgICAgIGlmKHZhbC5sZW5ndGggPCAzKSByZXR1cm47XG5cbiAgICAgICAgICAgIGQgPSAoZS5rZXlDb2RlID09IDM4KSA/IDEgOiAtMTtcblxuICAgICAgICAgICAgaWYocG9zPD12YWxbMF0ubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgdGhpcy52aWV3LmNoYW5nZW1vbnRoKGQpO1xuICAgICAgICAgICAgICAgIHRoaXMuc2V0U2VsZWN0ZWQodGhpcy52aWV3LnllYXIsIHRoaXMudmlldy5tb250aCwgdGhpcy5zZWxlY3RlZC5nZXREYXRlKCkpO1xuICAgICAgICAgICAgICAgIHRoaXMuc2V0KCk7XG4gICAgICAgICAgICAgICAgdGhpcy5lbGVtZW50LnNlbGVjdGlvblN0YXJ0ID0gcG9zO1xuICAgICAgICAgICAgICAgIHRoaXMuZWxlbWVudC5zZWxlY3Rpb25FbmQgPSBwb3M7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmKHBvcz52YWxbMF0ubGVuZ3RoICYmIHBvczw9KHZhbFswXS5sZW5ndGgrMSt2YWxbMV0ubGVuZ3RoKSkge1xuICAgICAgICAgICAgICAgIHRoaXMuc2V0U2VsZWN0ZWQodGhpcy52aWV3LnllYXIsIHRoaXMudmlldy5tb250aCwgdGhpcy5zZWxlY3RlZC5nZXREYXRlKCkgKyBkKTtcbiAgICAgICAgICAgICAgICB0aGlzLnNldCgpO1xuICAgICAgICAgICAgICAgIHRoaXMuZWxlbWVudC5zZWxlY3Rpb25TdGFydCA9IHBvcztcbiAgICAgICAgICAgICAgICB0aGlzLmVsZW1lbnQuc2VsZWN0aW9uRW5kID0gcG9zO1xuXG4gICAgICAgICAgICAgICAgdGhpcy52aWV3LnllYXIgPSB0aGlzLnNlbGVjdGVkLmdldEZ1bGxZZWFyKCk7XG4gICAgICAgICAgICAgICAgdGhpcy52aWV3Lm1vbnRoID0gdGhpcy5zZWxlY3RlZC5nZXRNb250aCgpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZihwb3M+KHZhbFswXS5sZW5ndGgrMSt2YWxbMV0ubGVuZ3RoKSkge1xuICAgICAgICAgICAgICAgIHRoaXMudmlldy5jaGFuZ2V5ZWFyKGQpO1xuICAgICAgICAgICAgICAgIHRoaXMuc2V0U2VsZWN0ZWQodGhpcy52aWV3LnllYXIsIHRoaXMudmlldy5tb250aCwgdGhpcy5zZWxlY3RlZC5nZXREYXRlKCkpO1xuXG4gICAgICAgICAgICAgICAgdGhpcy5zZXQoKTtcbiAgICAgICAgICAgICAgICB0aGlzLmVsZW1lbnQuc2VsZWN0aW9uU3RhcnQgPSBwb3M7XG4gICAgICAgICAgICAgICAgdGhpcy5lbGVtZW50LnNlbGVjdGlvbkVuZCA9IHBvcztcblxuICAgICAgICAgICAgICAgIHRoaXMudmlldy55ZWFyID0gdGhpcy5zZWxlY3RlZC5nZXRGdWxsWWVhcigpO1xuICAgICAgICAgICAgICAgIHRoaXMudmlldy5tb250aCA9IHRoaXMuc2VsZWN0ZWQuZ2V0TW9udGgoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGlmKHRoaXMuaXNPcGVuKCkgJiYgWzM3LDM4LDM5LDQwLDMyLDE2XS5pbmRleE9mKGUua2V5Q29kZSk+LTEpIHtcbiAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgIHN3aXRjaCAoZS5rZXlDb2RlKSB7XG4gICAgICAgICAgICAgICAgY2FzZSAzNzpcbiAgICAgICAgICAgICAgICAgICAgc3dpdGNoICh0aGlzLm1vZGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMDpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnNldFNlbGVjdGVkKHRoaXMudmlldy55ZWFyLCB0aGlzLnZpZXcubW9udGgsIHRoaXMuc2VsZWN0ZWQuZ2V0RGF0ZSgpIC0gMSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDE6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy52aWV3LmNoYW5nZW1vbnRoKC0xKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnNldFNlbGVjdGVkKHRoaXMudmlldy55ZWFyLCB0aGlzLnZpZXcubW9udGgsIHRoaXMuc2VsZWN0ZWQuZ2V0RGF0ZSgpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMjpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnZpZXcuY2hhbmdleWVhcigtMSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zZXRTZWxlY3RlZCh0aGlzLnZpZXcueWVhciwgdGhpcy52aWV3Lm1vbnRoLCB0aGlzLnNlbGVjdGVkLmdldERhdGUoKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSAzODpcbiAgICAgICAgICAgICAgICAgICAgc3dpdGNoICh0aGlzLm1vZGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMDpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnNldFNlbGVjdGVkKHRoaXMudmlldy55ZWFyLCB0aGlzLnZpZXcubW9udGgsIHRoaXMuc2VsZWN0ZWQuZ2V0RGF0ZSgpIC0gNyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDE6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy52aWV3LmNoYW5nZW1vbnRoKC0zKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnNldFNlbGVjdGVkKHRoaXMudmlldy55ZWFyLCB0aGlzLnZpZXcubW9udGgsIHRoaXMuc2VsZWN0ZWQuZ2V0RGF0ZSgpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMjpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnZpZXcuY2hhbmdleWVhcigtNCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zZXRTZWxlY3RlZCh0aGlzLnZpZXcueWVhciwgdGhpcy52aWV3Lm1vbnRoLCB0aGlzLnNlbGVjdGVkLmdldERhdGUoKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSAzOTpcbiAgICAgICAgICAgICAgICAgICAgc3dpdGNoICh0aGlzLm1vZGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMDpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnNldFNlbGVjdGVkKHRoaXMudmlldy55ZWFyLCB0aGlzLnZpZXcubW9udGgsIHRoaXMuc2VsZWN0ZWQuZ2V0RGF0ZSgpICsgMSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDE6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy52aWV3LmNoYW5nZW1vbnRoKDEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc2V0U2VsZWN0ZWQodGhpcy52aWV3LnllYXIsIHRoaXMudmlldy5tb250aCwgdGhpcy5zZWxlY3RlZC5nZXREYXRlKCkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAyOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMudmlldy5jaGFuZ2V5ZWFyKDEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc2V0U2VsZWN0ZWQodGhpcy52aWV3LnllYXIsIHRoaXMudmlldy5tb250aCwgdGhpcy5zZWxlY3RlZC5nZXREYXRlKCkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgNDA6XG4gICAgICAgICAgICAgICAgICAgIHN3aXRjaCAodGhpcy5tb2RlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDA6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zZXRTZWxlY3RlZCh0aGlzLnZpZXcueWVhciwgdGhpcy52aWV3Lm1vbnRoLCB0aGlzLnNlbGVjdGVkLmdldERhdGUoKSArIDcpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAxOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMudmlldy5jaGFuZ2Vtb250aCgzKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnNldFNlbGVjdGVkKHRoaXMudmlldy55ZWFyLCB0aGlzLnZpZXcubW9udGgsIHRoaXMuc2VsZWN0ZWQuZ2V0RGF0ZSgpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMjpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnZpZXcuY2hhbmdleWVhcig0KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnNldFNlbGVjdGVkKHRoaXMudmlldy55ZWFyLCB0aGlzLnZpZXcubW9udGgsIHRoaXMuc2VsZWN0ZWQuZ2V0RGF0ZSgpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlIDMyOlxuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5tb2RlID09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuaGlkZSgpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGVsc2UgdGhpcy5jaGFuZ2VWaWV3KC0xKTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSAxNjpcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5jaGFuZ2VWaWV3KDEpO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdGhpcy52aWV3LnllYXIgPSB0aGlzLnNlbGVjdGVkLmdldEZ1bGxZZWFyKCk7XG4gICAgICAgICAgICB0aGlzLnZpZXcubW9udGggPSB0aGlzLnNlbGVjdGVkLmdldE1vbnRoKCk7XG4gICAgICAgICAgICB0aGlzLnNldCgpO1xuICAgICAgICAgICAgdGhpcy5maWxsKCk7XG4gICAgICAgIH1cbiAgICB9LFxuXG4gICAgc2V0OiBmdW5jdGlvbigpIHtcbiAgICAgICAgdmFyIHN0ciA9ICcnO1xuXG4gICAgICAgIHN0ciArPSB1dGlsLmRhdGVzLm1vbnRoc1t0aGlzLnNlbGVjdGVkLmdldE1vbnRoKCldICsgXCIgXCI7XG4gICAgICAgIHN0ciArPSB0aGlzLnNlbGVjdGVkLmdldERhdGUoKSArIFwiIFwiO1xuICAgICAgICBzdHIgKz0gdGhpcy5zZWxlY3RlZC5nZXRGdWxsWWVhcigpO1xuXG4gICAgICAgIHRoaXMuZWxlbWVudC52YWx1ZSA9IHN0cjtcbiAgICAgICAgdGhpcy5wcmV2U3RhdGUgPSBzdHI7XG4gICAgfSxcblxuICAgIGZpbGxEb3c6IGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgaHRtbCA9ICcnLFxuICAgICAgICAgICAgaSA9IDA7XG4gICAgICAgIHdoaWxlIChpIDwgNykge1xuICAgICAgICAgICAgaHRtbCArPSAnPGRpdiBjbGFzcz1cImRvd1wiPicrdXRpbC5kYXRlcy5kYXlzU2hvcnRbKGkrKyldLnRvVXBwZXJDYXNlKCkrJzwvZGl2Pic7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5jYWxlbmRhci5xdWVyeVNlbGVjdG9yKCdkaXYuY2FsZW5kYXJoZWFkJykuaW5uZXJIVE1MID0gaHRtbDtcbiAgICB9LFxuXG4gICAgZmlsbE1vbnRoczogZnVuY3Rpb24obW9udGgpIHtcbiAgICAgICAgdmFyIGh0bWwgPSAnJyxcbiAgICAgICAgICAgIGNsLFxuICAgICAgICAgICAgaSA9IDA7XG4gICAgICAgIHdoaWxlIChpIDwgMTIpIHtcbiAgICAgICAgICAgIGNsID0gJyc7XG4gICAgICAgICAgICBpZih0aGlzLnNlbGVjdGVkICYmIGk9PXRoaXMuc2VsZWN0ZWQuZ2V0TW9udGgoKSkge1xuICAgICAgICAgICAgICAgIGNsID0gJyBhY3RpdmUnO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaHRtbCArPSAnPGRpdiBjbGFzcz1cIm1vbnRoJytjbCsnXCI+Jyt1dGlsLmRhdGVzLm1vbnRoc1Nob3J0WyhpKyspXSsnPC9kaXY+JztcbiAgICAgICAgfVxuICAgICAgICB0aGlzLm1vbnRoc3ZpZXcuaW5uZXJIVE1MID0gaHRtbDtcbiAgICB9LFxuXG4gICAgdXBkYXRlRGlzcGxheTogZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciB5ZWFyID0gdGhpcy52aWV3LnllYXIsXG4gICAgICAgICAgICBtb250aCA9IHRoaXMudmlldy5tb250aDtcblxuICAgICAgICBpZih0aGlzLm1vZGU9PTApXG4gICAgICAgICAgICB0aGlzLmRpc3BsYXkuaW5uZXJIVE1MID0gdXRpbC5kYXRlcy5tb250aHNbbW9udGhdICsgXCIgXCIgKyB5ZWFyO1xuICAgICAgICBlbHNlIGlmKHRoaXMubW9kZT09MSlcbiAgICAgICAgICAgIHRoaXMuZGlzcGxheS5pbm5lckhUTUwgPSB5ZWFyO1xuICAgICAgICBlbHNlIGlmKHRoaXMubW9kZT09Mikge1xuICAgICAgICAgICAgeWVhciA9IE1hdGguZmxvb3IoeWVhciAvIDE2KSAqIDE2O1xuICAgICAgICAgICAgdGhpcy5kaXNwbGF5LmlubmVySFRNTCA9IHllYXIgKyBcIiAtIFwiICsgKHllYXIgKyAxNSk7XG4gICAgICAgIH1cbiAgICB9LFxuXG4gICAgc2V0dG9kYXk6IGZ1bmN0aW9uKCkge1xuICAgICAgICB0aGlzLnNlbGVjdGVkID0gdGhpcy50b2RheTtcbiAgICAgICAgdGhpcy52aWV3LnllYXIgPSB0aGlzLnNlbGVjdGVkLmdldEZ1bGxZZWFyKCk7XG4gICAgICAgIHRoaXMudmlldy5tb250aCA9IHRoaXMuc2VsZWN0ZWQuZ2V0TW9udGgoKTtcbiAgICAgICAgdGhpcy5zZXQoKTtcbiAgICAgICAgdGhpcy5maWxsKCk7XG4gICAgICAgIHRoaXMuaGlkZSgpO1xuICAgIH0sXG5cbiAgICBmaWxsOiBmdW5jdGlvbigpIHtcbiAgICAgICAgdmFyIHllYXIgPSB0aGlzLnZpZXcueWVhcixcbiAgICAgICAgICAgIG1vbnRoID0gdGhpcy52aWV3Lm1vbnRoLFxuICAgICAgICAgICAgdG9kYXkgPSAwO1xuXG4gICAgICAgICAgICBpZih0aGlzLnNlbGVjdGVkKSB7XG4gICAgICAgICAgICAgICAgdG9kYXkgPSB0aGlzLnNlbGVjdGVkLnZhbHVlT2YoKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICBzd2l0Y2godGhpcy5tb2RlKSB7XG4gICAgICAgICAgICBjYXNlIDA6XG4gICAgICAgICAgICAgICAgdGhpcy51cGRhdGVEaXNwbGF5KCk7XG5cbiAgICAgICAgICAgICAgICB2YXIgcHJldk1vbnRoID0gbmV3IERhdGUoeWVhciwgbW9udGgtMSwgMjgsIDAsIDAsIDAsIDApLFxuICAgICAgICAgICAgICAgICAgICBkYXkgPSB1dGlsLmdldERheXNJbk1vbnRoKHByZXZNb250aC5nZXRGdWxsWWVhcigpLCBwcmV2TW9udGguZ2V0TW9udGgoKSk7XG4gICAgICAgICAgICAgICAgcHJldk1vbnRoLnNldERhdGUoZGF5KTtcbiAgICAgICAgICAgICAgICBwcmV2TW9udGguc2V0RGF0ZShkYXkgLSAocHJldk1vbnRoLmdldERheSgpICsgNykgJSA3KTtcblxuICAgICAgICAgICAgICAgIHZhciBuZXh0TW9udGggPSBuZXcgRGF0ZShwcmV2TW9udGgpO1xuICAgICAgICAgICAgICAgIG5leHRNb250aC5zZXREYXRlKG5leHRNb250aC5nZXREYXRlKCkgKyA0Mik7XG4gICAgICAgICAgICAgICAgbmV4dE1vbnRoID0gbmV4dE1vbnRoLnZhbHVlT2YoKTtcblxuICAgICAgICAgICAgICAgIHZhciBodG1sID0gXCJcIixcbiAgICAgICAgICAgICAgICAgICAgY2xhc3NuYW1lLFxuICAgICAgICAgICAgICAgICAgICBwcmV2WSxcbiAgICAgICAgICAgICAgICAgICAgcHJldk07XG5cbiAgICAgICAgICAgICAgICB3aGlsZShwcmV2TW9udGgudmFsdWVPZigpIDwgbmV4dE1vbnRoKSB7XG4gICAgICAgICAgICAgICAgICAgIHByZXZZID0gcHJldk1vbnRoLmdldEZ1bGxZZWFyKCk7XG4gICAgICAgICAgICAgICAgICAgIHByZXZNID0gcHJldk1vbnRoLmdldE1vbnRoKCk7XG4gICAgICAgICAgICAgICAgICAgIGNsYXNzbmFtZSA9IFwiXCI7XG4gICAgICAgICAgICAgICAgICAgIGlmICgocHJldk0gPCBtb250aCAmJiBwcmV2WSA9PT0geWVhcikgfHwgIHByZXZZIDwgeWVhcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgY2xhc3NuYW1lID0gJyBvbGQnO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKChwcmV2TSA+IG1vbnRoICYmIHByZXZZID09PSB5ZWFyKSB8fCBwcmV2WSA+IHllYXIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNsYXNzbmFtZSA9ICcgbmV3JztcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBpZiAocHJldk1vbnRoLnZhbHVlT2YoKSA9PT0gdGhpcy50b2RheS52YWx1ZU9mKCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNsYXNzbmFtZSA9ICcgbm93JztcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBpZiAocHJldk1vbnRoLnZhbHVlT2YoKSA9PT0gdG9kYXkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNsYXNzbmFtZSA9ICcgYWN0aXZlJztcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBodG1sKz0nPGRpdiBjbGFzcz1cImRheScrY2xhc3NuYW1lKydcIj4nKyBwcmV2TW9udGguZ2V0RGF0ZSgpICsgJzwvZGl2Pic7XG4gICAgICAgICAgICAgICAgICAgIHByZXZNb250aC5zZXREYXRlKHByZXZNb250aC5nZXREYXRlKCkrMSk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgdGhpcy5jYWxlbmRhcmJvZHkuaW5uZXJIVE1MID0gaHRtbDtcbiAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgY2FzZSAxOlxuICAgICAgICAgICAgICAgIHRoaXMuZmlsbE1vbnRocyhtb250aCk7XG4gICAgICAgICAgICAgICAgdGhpcy51cGRhdGVEaXNwbGF5KCk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgIGNhc2UgMjpcbiAgICAgICAgICAgICAgICBodG1sID0gJyc7XG4gICAgICAgICAgICAgICAgeWVhciA9IE1hdGguZmxvb3IoeWVhci8xNikgKiAxNjtcblxuICAgICAgICAgICAgICAgIHZhciBzZWxlY3RlZHllYXIgPSAwO1xuICAgICAgICAgICAgICAgIGlmKHRoaXMuc2VsZWN0ZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgc2VsZWN0ZWR5ZWFyID0gdGhpcy5zZWxlY3RlZC5nZXRGdWxsWWVhcigpO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHRoaXMudXBkYXRlRGlzcGxheSgpO1xuICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAtMTsgaSA8IDE1OyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgaHRtbCArPSAnPGRpdiBjbGFzcz1cInllYXInKyggc2VsZWN0ZWR5ZWFyID09PSB5ZWFyID8gJyBhY3RpdmUnIDogJycpKydcIj4nK3llYXIrJzwvZGl2Pic7XG4gICAgICAgICAgICAgICAgICAgIHllYXIgKz0gMTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdGhpcy55ZWFyc3ZpZXcuaW5uZXJIVE1MID0gaHRtbDtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuXG4gICAgfSxcblxuICAgIGhpZGVzaG93OiBmdW5jdGlvbigpIHtcbiAgICAgICAgaWYodGhpcy5jYWxlbmRhci5zdHlsZS5kaXNwbGF5PT0nYmxvY2snKSB7XG4gICAgICAgICAgICB0aGlzLmhpZGUoKTtcbiAgICAgICAgfSAgZWxzZSB7XG4gICAgICAgICAgICB0aGlzLnNob3coKTtcbiAgICAgICAgfVxuICAgIH0sXG5cbiAgICByZXNldHN1Z2dlc3Rpb246IGZ1bmN0aW9uKCkge1xuICAgICAgICB0aGlzLnN1Z2dlc3Rpb24udmFsdWUgPSBcIlwiO1xuICAgICAgICB0aGlzLnRpcG1vZGUgPSBmYWxzZTtcbiAgICB9LFxuXG4gICAgc2hvdzogZnVuY3Rpb24oKSB7XG4gICAgICAgIHRoaXMucGxhY2UoKTtcbiAgICAgICAgdGhpcy5wYXJzZSgpO1xuICAgICAgICB0aGlzLmNhbGVuZGFyLnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snO1xuICAgICAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigncmVzaXplJywgdGhpcy5wbGFjZS5iaW5kKHRoaXMpKTtcbiAgICB9LFxuXG4gICAgaGlkZTogZnVuY3Rpb24oKSB7XG4gICAgICAgIHRoaXMuY2FsZW5kYXIuc3R5bGUuZGlzcGxheSA9ICdub25lJztcbiAgICB9LFxuXG4gICAgcGxhY2U6IGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgb2ZmID0gdXRpbC5jYWxjdWxhdGVPZmZzZXQodGhpcy5lbGVtZW50KTtcbiAgICAgICAgdGhpcy5jYWxlbmRhci5zdHlsZS50b3AgPSBvZmYudG9wICsgdGhpcy5lbGVtZW50Lm9mZnNldEhlaWdodCArIDMgKyAncHgnO1xuICAgICAgICB0aGlzLmNhbGVuZGFyLnN0eWxlLmxlZnQgPSBvZmYubGVmdCArICdweCc7XG4gICAgfSxcblxuICAgIGNsaWNrOiBmdW5jdGlvbihlKSB7XG4gICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICAgICAgdmFyIHRhcmdldCA9IGUudGFyZ2V0O1xuICAgICAgICBzd2l0Y2godGFyZ2V0LmNsYXNzTmFtZSkge1xuICAgICAgICAgICAgY2FzZSAnaW5jIGNvbnRyb2wnOlxuICAgICAgICAgICAgY2FzZSAnZGVjIGNvbnRyb2wnOlxuICAgICAgICAgICAgICAgICAgICB0aGlzLnZpZXdbdGhpcy52aWV3Lm1vZGVzW3RoaXMubW9kZV0ucGFyYW1dLmNhbGwoXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnZpZXcsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAodGFyZ2V0LmNsYXNzTmFtZS5pbmRleE9mKCdkZWMnKSA+IC0xID8gLTEgOiAxKSAqIHRoaXMudmlldy5tb2Rlc1t0aGlzLm1vZGVdLnN0ZXBcbiAgICAgICAgICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZmlsbCgpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSAnZGlzcGxheSc6XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuY2hhbmdlVmlldygxKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5maWxsKCk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlICdkYXknOlxuICAgICAgICAgICAgY2FzZSAnZGF5IG9sZCc6XG4gICAgICAgICAgICBjYXNlICdkYXkgbmV3JzpcbiAgICAgICAgICAgIGNhc2UgJ2RheSBub3cnOlxuICAgICAgICAgICAgY2FzZSAnZGF5IGFjdGl2ZSc6XG4gICAgICAgICAgICAgICAgICAgIHZhciBjdXJtb250aCA9IHRoaXMudmlldy5tb250aDtcbiAgICAgICAgICAgICAgICAgICAgaWYodGFyZ2V0LmNsYXNzTmFtZS5pbmRleE9mKCdvbGQnKSA+IC0xKSB7XG4gICAgICAgICAgICAgICAgICAgICAgIGN1cm1vbnRoIC09IDE7XG4gICAgICAgICAgICAgICAgICAgICAgIHRoaXMudmlldy5jaGFuZ2Vtb250aCgtMSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgaWYodGFyZ2V0LmNsYXNzTmFtZS5pbmRleE9mKCduZXcnKSA+IC0xKSB7XG4gICAgICAgICAgICAgICAgICAgICAgIGN1cm1vbnRoICs9IDE7XG4gICAgICAgICAgICAgICAgICAgICAgIHRoaXMudmlldy5jaGFuZ2Vtb250aCgxKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB2YXIgZGF5ID0gcGFyc2VJbnQodGFyZ2V0LmlubmVySFRNTCwxMCk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc2V0U2VsZWN0ZWQodGhpcy52aWV3LnllYXIsY3VybW9udGgsZGF5KTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zZXQoKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5maWxsKCk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuaGlkZSgpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSAnbW9udGgnOlxuICAgICAgICAgICAgY2FzZSAnbW9udGggYWN0aXZlJzpcbiAgICAgICAgICAgICAgICAgICAgdGhpcy52aWV3Lm1vbnRoID0gdXRpbC5kYXRlcy5tb250aHNTaG9ydC5pbmRleE9mKHRhcmdldC5pbm5lckhUTUwpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmNoYW5nZVZpZXcoLTEpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmZpbGwoKTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgJ3llYXInOlxuICAgICAgICAgICAgY2FzZSAneWVhciBhY3RpdmUnOlxuICAgICAgICAgICAgICAgICAgICB0aGlzLnZpZXcueWVhciA9IHBhcnNlSW50KHRhcmdldC5pbm5lckhUTUwsMTApO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmNoYW5nZVZpZXcoLTEpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnVwZGF0ZURpc3BsYXkoKTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgJ3RvZGF5JzpcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zZXR0b2RheSgpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgIH1cbiAgICB9LFxuXG4gICAgY2hhbmdlVmlldzogZnVuY3Rpb24oaSkge1xuICAgICAgICBpZih0aGlzLm1vZGUgPj0gMiAmJiBpPT0xKSByZXR1cm47XG4gICAgICAgIHRoaXMubW9kZSArPSBpO1xuICAgICAgICBpZih0aGlzLm1vZGU9PTApIHtcbiAgICAgICAgICAgIHRoaXMubW9udGhzdmlldy5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xuICAgICAgICAgICAgdGhpcy5kYXlzdmlldy5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJztcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmKHRoaXMubW9kZT09MSkge1xuICAgICAgICAgICAgdGhpcy5kYXlzdmlldy5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xuICAgICAgICAgICAgdGhpcy55ZWFyc3ZpZXcuc3R5bGUuZGlzcGxheSA9ICdub25lJztcbiAgICAgICAgICAgIHRoaXMubW9udGhzdmlldy5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJztcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmKHRoaXMubW9kZT09Mil7XG4gICAgICAgICAgICB0aGlzLm1vbnRoc3ZpZXcuc3R5bGUuZGlzcGxheSA9ICdub25lJztcbiAgICAgICAgICAgIHRoaXMueWVhcnN2aWV3LnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snO1xuICAgICAgICB9XG4gICAgfVxufTtcblxud2luZG93LkRhdGVwaWNrZXIgPSBEYXRlcGlja2VyOyIsInZhciB1dGlsID0ge1xuICAgIGRhdGVzOntcbiAgICAgICAgZGF5czogW1wiU3VuZGF5XCIsIFwiTW9uZGF5XCIsIFwiVHVlc2RheVwiLCBcIldlZG5lc2RheVwiLCBcIlRodXJzZGF5XCIsIFwiRnJpZGF5XCIsIFwiU2F0dXJkYXlcIiwgXCJTdW5kYXlcIl0sXG4gICAgICAgIGRheXNTaG9ydDogW1wiU3VcIiwgXCJNb1wiLCBcIlR1XCIsIFwiV2VcIiwgXCJUaFwiLCBcIkZyXCIsIFwiU2FcIiwgXCJTdVwiXSxcbiAgICAgICAgbW9udGhzOiBbXCJKYW51YXJ5XCIsIFwiRmVicnVhcnlcIiwgXCJNYXJjaFwiLCBcIkFwcmlsXCIsIFwiTWF5XCIsIFwiSnVuZVwiLCBcIkp1bHlcIiwgXCJBdWd1c3RcIiwgXCJTZXB0ZW1iZXJcIiwgXCJPY3RvYmVyXCIsIFwiTm92ZW1iZXJcIiwgXCJEZWNlbWJlclwiXSxcbiAgICAgICAgbW9udGhzbG93OiBbXCJqYW51YXJ5XCIsIFwiZmVicnVhcnlcIiwgXCJtYXJjaFwiLCBcImFwcmlsXCIsIFwibWF5XCIsIFwianVuZVwiLCBcImp1bHlcIiwgXCJhdWd1c3RcIiwgXCJzZXB0ZW1iZXJcIiwgXCJvY3RvYmVyXCIsIFwibm92ZW1iZXJcIiwgXCJkZWNlbWJlclwiXSxcbiAgICAgICAgbW9udGhzU2hvcnQ6IFtcIkphblwiLCBcIkZlYlwiLCBcIk1hclwiLCBcIkFwclwiLCBcIk1heVwiLCBcIkp1blwiLCBcIkp1bFwiLCBcIkF1Z1wiLCBcIlNlcFwiLCBcIk9jdFwiLCBcIk5vdlwiLCBcIkRlY1wiXVxuICAgIH0sXG4gICAgc2VwYXJhdG9yczogWycgJywgJywnLCAnLScsICdcXFxcLicsICcvJywgJzonXSxcbiAgICBsZXR0ZXJzOiBbNzAsNjUsNjgsODMsNzksNzgsNzRdLFxuICAgIHBhcnNlTW9udGg6IGZ1bmN0aW9uKG1vbnRoKSB7IC8vVE9ETzogUHJvaGliaXRzIGNoYW5nZSB3aGVuIHZhbFswXSByZXR1cm5zIG5vdCBjb21wbGV0ZWQgbW9udGggaS5lLiAnU2VwdGVtYmUnXG4gICAgICBpZihpc05hTihtb250aCkpIHtcbiAgICAgICAgICByZXR1cm4gdXRpbC5kYXRlcy5tb250aHNsb3cuaW5kZXhPZihtb250aC50b0xvd2VyQ2FzZSgpKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgcmV0dXJuIG1vbnRoIC0gMTtcbiAgICAgIH1cbiAgICB9LFxuICAgIGlzTGVhcFllYXI6IGZ1bmN0aW9uICh5ZWFyKSB7XG4gICAgICAgIHJldHVybiAoKCh5ZWFyICUgNCA9PT0gMCkgJiYgKHllYXIgJSAxMDAgIT09IDApKSB8fCAoeWVhciAlIDQwMCA9PT0gMCkpXG4gICAgfSxcbiAgICBnZXREYXlzSW5Nb250aDogZnVuY3Rpb24gKHllYXIsIG1vbnRoKSB7XG4gICAgICAgIHJldHVybiBbMzEsICh1dGlsLmlzTGVhcFllYXIoeWVhcikgPyAyOSA6IDI4KSwgMzEsIDMwLCAzMSwgMzAsIDMxLCAzMSwgMzAsIDMxLCAzMCwgMzFdW21vbnRoXVxuICAgIH0sXG4gICAgY2FsY3VsYXRlT2Zmc2V0OiBmdW5jdGlvbihlbGVtZW50KSB7XG4gICAgICAgIHZhciB0b3AgPSAwLCBsZWZ0ID0gMDtcbiAgICAgICAgZG8ge1xuICAgICAgICAgICAgdG9wICs9IGVsZW1lbnQub2Zmc2V0VG9wICB8fCAwO1xuICAgICAgICAgICAgbGVmdCArPSBlbGVtZW50Lm9mZnNldExlZnQgfHwgMDtcbiAgICAgICAgICAgIGVsZW1lbnQgPSBlbGVtZW50Lm9mZnNldFBhcmVudDtcbiAgICAgICAgfSB3aGlsZShlbGVtZW50KTtcblxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgdG9wOiB0b3AsXG4gICAgICAgICAgICBsZWZ0OiBsZWZ0XG4gICAgICAgIH07XG4gICAgfSxcbiAgICBzZXRDaGFyQXQ6IGZ1bmN0aW9uKHN0ciwgaW5kZXgsIGNocikge1xuICAgICAgICBpZihpbmRleCA+IHN0ci5sZW5ndGgtMSkgcmV0dXJuIHN0cjtcbiAgICAgICAgcmV0dXJuIHN0ci5zdWJzdHIoMCxpbmRleCkgKyBjaHIgKyBzdHIuc3Vic3RyKGluZGV4KzEpO1xuICAgIH0sXG4gICAgY2hlY2tUZXh0OiBmdW5jdGlvbih0ZXh0KSB7XG4gICAgICAgIGZvcih2YXIgaT0wOyBpPDEyOyBpKyspIHtcbiAgICAgICAgICAgIGlmKHV0aWwuZGF0ZXMubW9udGhzbG93W2ldLmluZGV4T2YodGV4dC50b0xvd2VyQ2FzZSgpKSA9PSAwIHx8IHRleHQgPT0gKGkrMSkudG9TdHJpbmcoKSkge1xuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9LFxuICAgIGdldHRpcHM6IGZ1bmN0aW9uKHRleHQpIHtcbiAgICAgICAgdmFyIGFyciA9IFtdLCBtb250aHM7XG4gICAgICAgIGlmKHRleHRbMF0gPT0gdGV4dFswXS50b1VwcGVyQ2FzZSgpKSB7XG4gICAgICAgICAgICBtb250aHMgPSB1dGlsLmRhdGVzLm1vbnRocztcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIG1vbnRocyA9IHV0aWwuZGF0ZXMubW9udGhzbG93O1xuICAgICAgICB9XG5cbiAgICAgICAgZm9yKHZhciBpPTA7IGk8MTI7IGkrKykge1xuICAgICAgICAgICAgaWYodXRpbC5kYXRlcy5tb250aHNsb3dbaV0uaW5kZXhPZih0ZXh0LnRvTG93ZXJDYXNlKCkpID09IDApIHtcbiAgICAgICAgICAgICAgICBhcnIucHVzaChtb250aHNbaV0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBhcnI7XG4gICAgfSxcbiAgICBpbnNlcnRBZnRlcjogZnVuY3Rpb24obmV3Tm9kZSwgcmVmZXJlbmNlTm9kZSkge1xuICAgICAgICByZWZlcmVuY2VOb2RlLnBhcmVudE5vZGUuaW5zZXJ0QmVmb3JlKG5ld05vZGUsIHJlZmVyZW5jZU5vZGUubmV4dFNpYmxpbmcpO1xuICAgIH0sXG4gICAgdGVtcGxhdGU6ICAgJzxkaXYgY2xhc3M9XCJkYXRlcGlja2VyYm9keVwiPicrXG4gICAgICAgICAgICAgICAgICAgICc8ZGl2IGNsYXNzPVwiaGVhZFwiPicrXG4gICAgICAgICAgICAgICAgICAgICAgICAnPGRpdiBjbGFzcz1cImRlYyBjb250cm9sXCI+PC9kaXY+JytcbiAgICAgICAgICAgICAgICAgICAgICAgICc8ZGl2IGNsYXNzPVwiZGlzcGxheVwiPlNlcHRlbWJlciAyMDE0PC9kaXY+JytcbiAgICAgICAgICAgICAgICAgICAgICAgICc8ZGl2IGNsYXNzPVwiaW5jIGNvbnRyb2xcIj48L2Rpdj4nK1xuICAgICAgICAgICAgICAgICAgICAnPC9kaXY+JytcbiAgICAgICAgICAgICAgICAgICAgJzxkaXYgY2xhc3M9XCJib2R5XCI+JytcbiAgICAgICAgICAgICAgICAgICAgICAgICc8ZGl2IGNsYXNzPVwiZGF5c3ZpZXdcIj4nK1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICc8ZGl2IGNsYXNzPVwiY2FsZW5kYXJoZWFkXCI+JytcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAnPC9kaXY+JytcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAnPGRpdiBjbGFzcz1cImNhbGVuZGFyXCI+JytcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAnPC9kaXY+JytcbiAgICAgICAgICAgICAgICAgICAgICAgICc8L2Rpdj4nK1xuICAgICAgICAgICAgICAgICAgICAgICAgJzxkaXYgY2xhc3M9XCJtb250aHN2aWV3XCI+JytcbiAgICAgICAgICAgICAgICAgICAgICAgICc8L2Rpdj4nK1xuICAgICAgICAgICAgICAgICAgICAgICAgJzxkaXYgY2xhc3M9XCJ5ZWFyc3ZpZXdcIj4nK1xuICAgICAgICAgICAgICAgICAgICAgICAgJzwvZGl2PicrXG4gICAgICAgICAgICAgICAgICAgICc8L2Rpdj4nK1xuICAgICAgICAgICAgICAgICAgICAnPGRpdiBjbGFzcz1cInRvZGF5XCI+VG9kYXk8L2Rpdj4nK1xuICAgICAgICAgICAgICAgICc8L2Rpdj4nLFxuICAgIHNlY3JldFRlbXBsYXRlOiAnPHNwYW4+PHNwYW4gY2xhc3M9XCJidXR0b24tc2hvd1wiPjxkaXYgY2xhc3M9XCJpY29uLTFcIj48ZGl2IGNsYXNzPVwiaWNvbi0yXCI+PC9kaXY+PC9kaXY+PC9zcGFuPjwvc3Bhbj4nLFxuICAgIHN1Z2dlc3Rpb25UZW1wbGF0ZTogJzxkaXY+PGlucHV0IGNsYXNzPVwic3VnZ2VzdGlvblwiIGRpc2FibGVkIHR5cGU9XCJ0ZXh0XCI+PC9kaXY+J1xufTtcblxubW9kdWxlLmV4cG9ydHMgPSB1dGlsOyIsInZhciBWaWV3dHJhY2tlciA9IGZ1bmN0aW9uKG1vbnRoLCB5ZWFyKSB7XG5cbiAgICB0aGlzLm1vbnRoID0gbW9udGg7XG4gICAgdGhpcy55ZWFyID0geWVhcjtcblxuICAgIHRoaXMuY2hhbmdlbW9udGggPSBmdW5jdGlvbihpKSB7XG4gICAgICAgIHRoaXMubW9udGgrPWk7XG4gICAgICAgIGlmKHRoaXMubW9udGg9PTEyKSB7XG4gICAgICAgICAgICB0aGlzLm1vbnRoPTA7XG4gICAgICAgICAgICB0aGlzLnllYXIrPTE7XG4gICAgICAgIH1cbiAgICAgICAgaWYodGhpcy5tb250aD09LTEpIHtcbiAgICAgICAgICAgIHRoaXMubW9udGg9MTE7XG4gICAgICAgICAgICB0aGlzLnllYXItPTE7XG4gICAgICAgIH1cbiAgICB9O1xuXG4gICAgdGhpcy5jaGFuZ2V5ZWFyID0gZnVuY3Rpb24oaSkge1xuICAgICAgICB0aGlzLnllYXIrPWk7XG4gICAgfTtcblxuICAgIHRoaXMubW9kZXMgPSBbXG4gICAgICAgIHtcbiAgICAgICAgICAgIFwicGFyYW1cIjpcImNoYW5nZW1vbnRoXCIsXG4gICAgICAgICAgICBcInN0ZXBcIjoxXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIFwicGFyYW1cIjpcImNoYW5nZXllYXJcIixcbiAgICAgICAgICAgIFwic3RlcFwiOjFcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgXCJwYXJhbVwiOlwiY2hhbmdleWVhclwiLFxuICAgICAgICAgICAgXCJzdGVwXCI6MTZcbiAgICAgICAgfVxuICAgIF1cbn07XG5cbm1vZHVsZS5leHBvcnRzID0gVmlld3RyYWNrZXI7Il19
